var AjaxLoader=function(){function n(){}return n.prototype.InitAjaxLoads=function(){for(var t=document.getElementsByClassName("ajax-load-html"),n=0;n<t.length;n++)this.LoadInnerHtmlToElement(t[n],null)},n.prototype.LoadInnerHtmlToElement=function(n,t){var r=$(n).data("ajax-link"),i=$(n).data("ajax-method"),f=$(n).data("request-data"),u=$(n).data("on-finish-script");i==null&&(i="GET");$.ajax({type:i,url:r,cache:!1,data:f,success:function(i){$(n).html(i);$(n).removeClass("ajax-load-html");u&&eval(u);t&&t()},error:function(n){alert("There is an execption while executing request "+r);console.log(n)}})},n}(),FormDrawImplementation=function(){function n(n){this._datePickerPropNames=[];this._selectClass="form-draw-select";this._model=n;this._htmlDrawHelper=new HtmlSelectDrawHelper(CrocoAppCore.Application.FormDataHelper.NullValue)}return n.prototype.BeforeFormDrawing=function(){},n.prototype.AfterFormDrawing=function(){var t,i;for($("."+this._selectClass).selectpicker("refresh"),t=0;t<this._datePickerPropNames.length;t++)i=this._datePickerPropNames[t],n.InitCalendarForPrefixedProperty(this._model.Prefix,i)},n.prototype.GetPropertyName=function(n){return FormDrawHelper.GetPropertyValueName(n,this._model.Prefix)},n.prototype.GetPropertyBlock=function(n){return this._model.Blocks.find(function(t){return t.PropertyName===n})},n.GetElementIdForFakeCalendar=function(n,t){var i=n+"_"+t+"FakeCalendar";return i.replace(new RegExp(/\./,"g"),"_")},n.GetElementIdForRealCalendarBackProperty=function(n,t){var i=n+"_"+t+"RealCalendar";return i.replace(new RegExp(/\./,"g"),"_")},n.InitCalendarForPrefixedProperty=function(t,i){var r=n.GetElementIdForFakeCalendar(t,i),u=n.GetElementIdForRealCalendarBackProperty(t,i);DatePickerUtils.SetDatePicker(r,u)},n.prototype.GetPropValue=function(n){return ValueProviderHelper.GetStringValueFromValueProvider(n,this._model.ValueProvider)},n.prototype.RenderDatePicker=function(t,i){var r=t.PropertyDescription.PropertyName,u=this.GetPropertyName(r),f,e;return this._datePickerPropNames.push(r),f=n.GetElementIdForFakeCalendar(this._model.Prefix,r),e=(new Map).set("id",n.GetElementIdForRealCalendarBackProperty(this._model.Prefix,r)).set(CrocoAppCore.Application.FormDataHelper.DataTypeAttributeName,CSharpType.String.toString()),this.RenderTextBoxInner(t,i,f,u+"Fake")+FormDrawHelper.GetInputTypeHidden(u,"",e)},n.prototype.RenderHidden=function(n){var t=this.GetPropValue(n);return FormDrawHelper.GetInputTypeHidden(FormDrawHelper.GetPropertyValueName(n.PropertyDescription.PropertyName,this._model.Prefix),t,null)},n.prototype.RenderTextBox=function(n,t){return this.RenderTextBoxInner(n,t,null,this.GetPropertyName(n.PropertyDescription.PropertyName))},n.prototype.RenderTextBoxInner=function(n,t,i,r){var f,o=ValueProviderHelper.GetStringValueFromValueProvider(n,this._model.ValueProvider),s=i==null?"":' id="'+i+'"',u=this.GetPropertyBlock(n.PropertyDescription.PropertyName),h=((f=u.TextBoxData)===null||f===void 0?void 0:f.IsInteger)?CSharpType.Int:CSharpType.String,c=CrocoAppCore.Application.FormDataHelper.DataTypeAttributeName+"="+h.toString(),l=u.TextBoxData.IsInteger?'type="number" step="'+u.TextBoxData.IntStep+'"':'type="text"',e='<label for="'+n.PropertyDescription.PropertyName+'">'+u.LabelText+"<\/label>\n                <input"+s+' autocomplete="off" class="form-control m-input" name="'+r+'" '+c+" "+l+' value="'+o+'" />';return t?this.WrapInForm(n,e):e},n.prototype.RenderTextArea=function(n,t){var r=ValueProviderHelper.GetStringValueFromValueProvider(n,this._model.ValueProvider),u=this.GetPropertyBlock(n.PropertyDescription.PropertyName),i='<label for="'+n.PropertyDescription.PropertyName+'">'+u.LabelText+'<\/label>\n            <textarea autocomplete="off" class="form-control m-input" name="'+this.GetPropertyName(n.PropertyDescription.PropertyName)+'" rows="3" style="margin-top: 0px; margin-bottom: 0px; height: 79px;">'+r+"<\/textarea>";return t?this.WrapInForm(n,i):i},n.prototype.RenderGenericDropList=function(n,t,i,r){var f=ValueProviderHelper.GetRawValueFromValueProvider(n,this._model.ValueProvider);this._htmlDrawHelper.ProccessSelectValues(n,f,t);var e=this._selectClass+" form-control m-input m-bootstrap-select m_selectpicker",o=i?(new Map).set("multiple",""):null,s=HtmlDrawHelper.RenderSelect(e,this.GetPropertyName(n.PropertyDescription.PropertyName),t,o),h=this.GetPropertyBlock(n.PropertyDescription.PropertyName),u='<label for="'+n.PropertyDescription.PropertyName+'">'+h.LabelText+"<\/label>"+s;return r?this.WrapInForm(n,u):u},n.prototype.WrapInForm=function(n,t){return'<div class="form-group m-form__group" '+FormDrawHelper.GetOuterFormAttributes(n.PropertyDescription.PropertyName,this._model.Prefix)+">\n                    "+t+"\n                <\/div>"},n.prototype.RenderDropDownList=function(n,t,i){return this.RenderGenericDropList(n,t,!1,i)},n.prototype.RenderMultipleDropDownList=function(n,t,i){return this.RenderGenericDropList(n,t,!0,i)},n}(),Logger_Resx=function(){function n(){this.LoggingAttempFailed="Произошла ошибка в логгировании ошибки, срочно обратитесь к разработчикам приложения";this.ErrorOnApiRequest="Ошибка запроса к апи";this.ActionLogged="Action logged";this.ExceptionLogged="Исключение залоггировано";this.ErrorOccuredOnLoggingException="Произошла ошибка в логгировании ошибки, срочно обратитесь к разработчикам приложения"}return n}(),Logger=function(){function n(){}return n.prototype.LogException=function(t,i,r){var u={ExceptionDate:(new Date).toISOString(),Description:i,Message:t,Uri:r!==null?r:location.href};CrocoAppCore.Application.Requester.Post("/Api/Log/Exception",u,function(t){return console.log(n.Resources.ExceptionLogged,t)},function(){return alert(n.Resources.ErrorOccuredOnLoggingException)})},n.prototype.LogAction=function(t,i,r,u){var f={LogDate:(new Date).toISOString(),EventId:r,ParametersJson:u,Uri:window.location.href,Description:i,Message:t};CrocoAppCore.Application.Requester.Post("/Api/Log/Action",f,function(t){return console.log(n.Resources.ActionLogged,t)},function(){return alert(n.Resources.LoggingAttempFailed)})},n.Resources=new Logger_Resx,n}(),ModalWorker=function(){function n(){}return n.prototype.ShowModal=function(t){(t===""||t==null||t==undefined)&&(t=n.LoadingModal);$("#"+t).modal("show")},n.prototype.ShowLoadingModal=function(){this.ShowModal(n.LoadingModal)},n.prototype.HideModals=function(){$(".modal").modal("hide");$(".modal-backdrop.fade").remove();$(".modal").on("shown.bs.modal",function(){})},n.prototype.HideModal=function(n){$("#"+n).modal("hide")},n.LoadingModal="loadingModal",n}(),MyCrocoJsApplication=function(){function n(){this.CookieWorker=new CookieWorker;this.FormDataUtils=new FormDataUtils;this.FormDataHelper=new FormDataHelper;this.Logger=new Logger;this.Requester=new Requester;this.ModalWorker=new ModalWorker}return n}(),Requester_Resx=function(){function n(){this.YouPassedAnEmtpyArrayOfObjects="Вы подали пустой объект в запрос";this.ErrorOccuredWeKnowAboutIt="Произошла ошибка! Мы уже знаем о ней, и скоро с ней разберемся!";this.FilesNotSelected="Файлы не выбраны"}return n}(),Requester=function(){function n(){}return n.prototype.DeleteCompletedRequest=function(t){n.GoingRequests=n.GoingRequests.filter(function(n){return n!==t})},n.prototype.SendPostRequestWithAnimation=function(n,t,i,r){this.SendAjaxPostInner(n,t,i,r,!0)},n.prototype.UploadFilesToServer=function(t,i,r,u){var o=this,e=$("#"+t).prop("files"),s=new FormData,f;if(e.length===0){CrocoAppCore.ToastrWorker.ShowError(n.Resources.FilesNotSelected);u&&u();return}for(f=0;f<e.length;f++)s.append("Files",e[f]);$.ajax({url:i,type:"POST",data:s,async:!0,cache:!1,dataType:"json",contentType:!1,processData:!1,success:function(n){o.DeleteCompletedRequest(i);r&&r(n)}.bind(this),error:function(t,r,f){CrocoAppCore.Application.Logger.LogException(r.toString(),"ErrorOnApiRequest",i);o.DeleteCompletedRequest(i);CrocoAppCore.Application.ModalWorker.HideModals();CrocoAppCore.ToastrWorker.ShowError(n.Resources.ErrorOccuredWeKnowAboutIt);u&&u(t,r,f)}.bind(this)})},n.OnSuccessAnimationHandler=function(n){CrocoAppCore.Application.ModalWorker.HideModals();CrocoAppCore.ToastrWorker.HandleBaseApiResponse(n)},n.OnErrorAnimationHandler=function(){CrocoAppCore.Application.ModalWorker.HideModals();CrocoAppCore.ToastrWorker.ShowError(n.Resources.ErrorOccuredWeKnowAboutIt)},n.prototype.Get=function(n,t,i,r){var u=this,f={type:"GET",data:t,url:n,async:!0,cache:!1,success:function(t){u.DeleteCompletedRequest(n);i&&i(t)}.bind(this),error:function(t,i,f){CrocoAppCore.Application.Logger.LogException(i.toString(),"Error on Api Request",n);u.DeleteCompletedRequest(n);r&&r(t,i,f)}.bind(this)};$.ajax(f)},n.prototype.SendAjaxPostInner=function(t,i,r,u,f){var o=this,e,s;if(i==null){alert(n.Resources.YouPassedAnEmtpyArrayOfObjects);return}e={};e.type="POST";e.data=i;e.url=t;e.async=!0;e.cache=!1;e.success=function(i){o.DeleteCompletedRequest(t);f&&n.OnSuccessAnimationHandler(i);r&&r(i)}.bind(this);e.error=function(i,r,e){CrocoAppCore.Application.Logger.LogException(r.toString(),"Error on Api Request",t);o.DeleteCompletedRequest(t);f&&n.OnErrorAnimationHandler();u&&u(i,r,e)}.bind(this);s=i.constructor===Array;s&&(e.contentType="application/json; charset=utf-8",e.dataType="json",e.data=JSON.stringify(i));n.GoingRequests.push(t);$.ajax(e)},n.prototype.Post=function(n,t,i,r){this.SendAjaxPostInner(n,t,i,r,!1)},n.Resources=new Requester_Resx,n.GoingRequests=[],n}(),TabFormDrawImplementation=function(){function n(n){this._datePickerPropNames=[];this._selectClass="form-draw-select";this._model=n;this._drawHelper=new HtmlSelectDrawHelper(CrocoAppCore.Application.FormDataHelper.NullValue)}return n.prototype.BeforeFormDrawing=function(){},n.prototype.AfterFormDrawing=function(){var n,t;for($("."+this._selectClass).selectpicker("refresh"),n=0;n<this._datePickerPropNames.length;n++)t=this._datePickerPropNames[n],FormDrawImplementation.InitCalendarForPrefixedProperty(this._model.Prefix,t)},n.prototype.RenderTextBox=function(n){var t=ValueProviderHelper.GetStringValueFromValueProvider(n,this._model.ValueProvider);return'<div class="form-group m-form__group row">\n                    <label class="col-xl-3 col-lg-3 col-form-label">\n                        '+n.PropertyDescription.PropertyDisplayName+':\n                    <\/label>\n                    <div class="col-xl-9 col-lg-9">\n                        <div class="input-group">\n                            <input type="text" name="'+this.GetPropertyValueName(n.PropertyDescription.PropertyName)+'" class="form-control m-input" placeholder="" value="'+t+'">\n                        <\/div>\n                    <\/div>\n                <\/div>'},n.prototype.RenderTextArea=function(n){var t=ValueProviderHelper.GetStringValueFromValueProvider(n,this._model.ValueProvider);return'<div class="form-group m-form__group row">\n                    <label class="col-xl-3 col-lg-3 col-form-label">'+n.PropertyDescription.PropertyDisplayName+'<\/label>\n                    <div class="col-xl-9 col-lg-9">\n                        <textarea class="form-control m-input" name="'+this.GetPropertyValueName(n.PropertyDescription.PropertyName)+'" rows="3">'+t+"<\/textarea>\n                    <\/div>\n                <\/div>"},n.prototype.RenderGenericDropList=function(n,t,i){var r=ValueProviderHelper.GetRawValueFromValueProvider(n,this._model.ValueProvider);this._drawHelper.ProccessSelectValues(n,r,t);var u=this._selectClass+" form-control m-input m-bootstrap-select m_selectpicker",f=i?(new Map).set("multiple",""):null,e=HtmlDrawHelper.RenderSelect(u,this.GetPropertyValueName(n.PropertyDescription.PropertyName),t,f);return'<div class="form-group m-form__group row">\n                    <label class="col-xl-3 col-lg-3 col-form-label">'+n.PropertyDescription.PropertyDisplayName+':<\/label>\n                    <div class="col-xl-9 col-lg-9">\n                        '+e+"\n                    <\/div>\n                <\/div>"},n.prototype.RenderDropDownList=function(n,t){return this.RenderGenericDropList(n,t,!1)},n.prototype.RenderMultipleDropDownList=function(n,t){return this.RenderGenericDropList(n,t,!0)},n.prototype.RenderHidden=function(n){var t=ValueProviderHelper.GetStringValueFromValueProvider(n,this._model.ValueProvider);return'<input type="hidden" name="'+this.GetPropertyValueName(n.PropertyDescription.PropertyName)+'" value="'+t+'">'},n.prototype.RenderDatePicker=function(n){return this._datePickerPropNames.push(n.PropertyDescription.PropertyName),this.RenderTextBox(n)},n.prototype.GetPropertyValueName=function(n){return""+this._model.Prefix+n},n}(),ToastrWorker=function(){function n(){}return n.prototype.ShowError=function(n){var t={IsSucceeded:!1,Message:n};this.HandleBaseApiResponse(t)},n.prototype.ShowSuccess=function(n){var t={IsSucceeded:!0,Message:n};this.HandleBaseApiResponse(t)},n.prototype.HandleBaseApiResponse=function(n){if(n.IsSucceeded===undefined||n.Message===undefined){alert("Произошла ошибка. Объект не является типом BaseApiResponse");return}toastr.options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};n.IsSucceeded?toastr.success(n.Message):toastr.error(n.Message)},n}(),CrocoAppCore=function(){function n(){}return n.GetFormDrawFactory=function(){return new FormDrawFactory({DefaultImplementation:function(n){return new FormDrawImplementation(n)},Implementations:(new Map).set("Default",function(n){return new FormDrawImplementation(n)}).set("Tab",function(n){return new TabFormDrawImplementation(n)})})},n.InitFields=function(){n.Application=new MyCrocoJsApplication;n.AjaxLoader=new AjaxLoader;n.ToastrWorker=new ToastrWorker;n.GenericInterfaceHelper=new GenericInterfaceAppHelper;n.AjaxLoader.InitAjaxLoads()},n}();